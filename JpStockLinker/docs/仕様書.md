# 📊 JpStockLinker v7.3.1 仕様書

## 1. 概要

**JpStockLinker**は、日本株の銘柄情報を効率的に管理し、各種株式情報サイトへワンタップでアクセスできるAndroidアプリです。

### 1.1 コンセプト
- 複数の株式情報サイトを**銘柄コード入力なし**で横断的にアクセス
- お気に入り銘柄の**グループ管理**
- **ホーム画面ウィジェット**で素早くアクセス
- **折りたたみスマホ対応**（デュアルペイン表示）

### 1.2 対象ユーザー
- 日本株の個人投資家
- 複数サイトで銘柄分析を行うユーザー
- Galaxy Z Fold等の折りたたみスマホユーザー

---

## 2. 機能一覧

### 2.1 銘柄管理機能

| 機能 | 説明 |
|------|------|
| 銘柄検索 | コード・社名・セクター・テーマで検索（ひらがな/カタカナ変換対応） |
| サジェスト | 2文字以上入力で候補表示（最大10件） |
| 銘柄登録 | マイリストに銘柄を追加 |
| 銘柄削除 | マイリストから銘柄を削除 |
| お気に入り | ★マークでお気に入り登録（リスト上部に表示） |
| メモ機能 | 銘柄ごとにメモを保存 |
| グループ管理 | 銘柄をグループ（監視中/保有中/検討中/売却済等）に分類 |

### 2.2 リンク機能（個別銘柄）

選択した銘柄コードで以下のサイトにワンタップアクセス：

| サイト | URL | 用途 |
|--------|-----|------|
| Yahoo!ファイナンス | finance.yahoo.co.jp | チャート・ニュース |
| 株探 | kabutan.jp | 決算・材料 |
| TradingView | jp.tradingview.com | テクニカル分析 |
| みんかぶ | minkabu.jp | 目標株価・予想 |
| 日経 | nikkei.com | ニュース |
| バフェット・コード | buffett-code.com | 財務分析 |
| IR BANK | irbank.net | IR情報 |
| 株ドラゴン | kabudragon.com | チャート |
| 機関足跡 | japan-kabuka.com | 機関投資家動向 |
| 空売りネット | karauri.net | 空売り残高 |
| 四季報オンライン | shikiho.toyokeizai.net | 四季報 |
| 日証金 | taisyaku.jp | 貸借取引残高 |

### 2.3 リンク機能（市場全体）

銘柄選択不要でアクセス可能：

| サイト | URL | 用途 |
|--------|-----|------|
| 世界の株価 | nikkei225jp.com | 指数一覧 |
| 日経先物 | nikkei225jp.com | 先物・CME |
| 上昇率ランキング | kabutan.jp | 値上がり銘柄 |
| 下落率ランキング | kabutan.jp | 値下がり銘柄 |
| 決算カレンダー | kabuyoho.jp | 決算発表予定 |
| ヒートマップ | moomoo.com | セクター別騰落 |

### 2.4 ホーム画面ウィジェット

| 機能 | 説明 |
|------|------|
| お気に入り一覧表示 | お気に入り登録した銘柄をウィジェットに表示 |
| 銘柄選択 | 「選択」ボタンで銘柄を選択（シアン枠でハイライト） |
| クイックリンク | Yahoo!/株探/IR/決算へワンタップ |
| アプリ起動 | 検索バータップでアプリ起動 |
| 自動更新 | 30分ごとに自動更新 |

### 2.5 ニュース機能（折りたたみ対応）

| 機能 | 説明 |
|------|------|
| 経済ニュース | Yahoo!ニュース（経済）をRSS取得 |
| 適時開示 | TDnet（東証適時開示）をRSS取得 |
| デュアルペイン | 折りたたみスマホ展開時に2画面表示 |
| スワイプナビ | シングルペイン時はスワイプで切替 |

### 2.6 グループ機能

| 機能 | 説明 |
|------|------|
| デフォルトグループ | 監視中/保有中/検討中/売却済 |
| グループ追加 | 任意のグループを追加可能 |
| グループ編集 | 名前・アイコン・色を変更可能 |
| グループ削除 | グループ削除時、銘柄は「すべて」に移動 |
| タブ切替 | グループタブで表示をフィルタリング |

---

## 3. データ構造

### 3.1 銘柄データ（StockItem）

```kotlin
data class StockItem(
    val code: String,           // 銘柄コード（4桁）
    val name: String,           // 銘柄名
    var memo: String,           // ユーザーメモ
    var isFavorite: Boolean,    // お気に入りフラグ
    var lastSearchedAt: Long,   // 最終アクセス日時
    var sector: String,         // セクター
    var themes: List<String>,   // テーマタグ
    var groupId: String?        // 所属グループID
)
```

### 3.2 グループデータ（Group）

```kotlin
data class Group(
    val id: String,     // UUID
    var name: String,   // グループ名
    var color: String,  // カラーコード
    var icon: String,   // 絵文字アイコン
    var order: Int      // 表示順
)
```

### 3.3 マスターデータ（stock_master.json）

約4,000銘柄の基本情報を含むJSONファイル：
- 銘柄コード
- 銘柄名（漢字/カナ）
- セクター
- 市場区分
- テーマタグ

---

## 4. 技術仕様

### 4.1 開発環境

| 項目 | 値 |
|------|-----|
| 言語 | Kotlin |
| 最小SDK | Android 7.0 (API 24) |
| ターゲットSDK | Android 14 (API 34) |
| ビルドツール | Gradle 8.2 |
| AGP | 8.2.0 |

### 4.2 主要ライブラリ

| ライブラリ | 用途 |
|-----------|------|
| Material Design 3 | UIコンポーネント |
| AndroidX Window | 折りたたみデバイス対応 |
| SlidingPaneLayout | デュアルペイン |
| Gson | JSON解析 |
| RSS Parser | ニュースフィード取得 |
| Chrome Custom Tabs | アプリ内ブラウザ |
| ViewBinding | View参照 |

### 4.3 データ永続化

| データ | 保存先 |
|--------|--------|
| 銘柄リスト | SharedPreferences (JSON) |
| グループリスト | SharedPreferences (JSON) |
| UI状態 | SharedPreferences |
| マスターデータ | assets/stock_master.json |

### 4.4 ウィジェット

| 項目 | 値 |
|------|-----|
| 最小サイズ | 250dp × 110dp |
| 更新間隔 | 30分 |
| リサイズ | 水平・垂直対応 |

---

## 5. UI/UX設計

### 5.1 カラースキーム（ダークモード）

| 要素 | カラー |
|------|--------|
| 背景 | #0B0F14 |
| カード背景 | #121821 |
| アクセント | #00C2D1（シアン） |
| テキスト | #E6F0F2 |
| 選択枠 | #00C2D1 |

### 5.2 レイアウト

- **シングルペイン**: 通常スマホ
- **デュアルペイン**: 折りたたみスマホ展開時/タブレット（600dp以上）

### 5.3 アニメーション

- リンクドック展開/折りたたみ: 300ms
- グループタブ切替: 即時
- ウィジェット更新: リスト再描画

---

## 6. 画面構成

```
┌─────────────────────────────────┐
│ 📊 JpStockLinker      v7.3.1   │
├─────────────────────────────────┤
│ [🔍 検索バー          ] [+]    │
├─────────────────────────────────┤
│ 選択中: 7203 トヨタ自動車       │
│ [EV] [自動運転]                 │
├─────────────────────────────────┤
│ [🔽 リンクを表示]               │
│ ┌─────────────────────────────┐ │
│ │ 📊 銘柄情報                 │ │
│ │ [Yahoo!][株探][TradingView] │ │
│ │ [みんかぶ][日経][バフェット] │ │
│ │ ...                         │ │
│ │ 🌍 市場全体                 │ │
│ │ [世界株価][日経先物]        │ │
│ │ [上昇率][決算カレンダー]    │ │
│ │ [下落率][ヒートマップ]      │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ [すべて][監視中][保有中][+]     │
├─────────────────────────────────┤
│ 📋 マイリスト           10件   │
│ ┌─────────────────────────────┐ │
│ │ ★ 7203 トヨタ自動車        │ │
│ │ ★ 6758 ソニーグループ      │ │
│ │ ...                         │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘
```

---

## 7. 今後の拡張予定

- [ ] 株価データ取得・表示
- [ ] ポートフォリオ管理
- [ ] 銘柄比較機能
- [ ] データエクスポート/インポート
- [ ] ウィジェットデザインカスタマイズ
- [ ] 通知機能（決算日アラート等）

---

## 8. バージョン履歴

| バージョン | 主な変更点 |
|------------|-----------|
| v7.3.1 | ウィジェット選択機能追加、UI改善 |
| v7.3 | リンクドック実装、ヘッダートグル |
| v7.2 | 日証金リンク追加 |
| v6.7 | スワイプナビゲーション |
| v6.5 | 折りたたみデバイス対応 |
| v6.0 | グループ機能追加 |
| v5.4 | リンクボタン追加 |
| v5.3 | マスターデータ検索強化 |

---

*最終更新: 2026年1月17日*
